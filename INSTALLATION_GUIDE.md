# Installation & Setup Guide

## Quick Start

### 1. Prerequisites
- Python 3.8 or higher
- pip (Python package manager)
- Git

### 2. Clone the Repository
```bash
git clone <your-repo-url>
cd ncf22
```

### 3. Create Virtual Environment (Recommended)

**On Windows:**
```bash
python -m venv venv
venv\Scripts\activate
```

**On macOS/Linux:**
```bash
python3 -m venv venv
source venv/bin/activate
```

### 4. Install Dependencies
```bash
pip install -r requirements.txt
```

## Dataset Setup

You'll need the following CSV files in the project root:
- `meal.csv` - Meal/bundle definitions
- `recipe.csv` - Individual recipe data with nutrition
- `user_meal.csv` - User-meal interactions
- `user_recipe.csv` - User-recipe ratings

### Expected CSV Columns

**recipe.csv:**
```
recipe_id, recipe_name, category, aver_rate, nutritions
```

**user_recipe.csv:**
```
user_id, recipe_id, rating
```

## Running the Pipeline

Execute the scripts in order:

### Step 1: Data Preprocessing
```bash
python 1.py
```
**Outputs:** `processed_data.pkl`, `interaction_matrix.csv`, `recipe_features.csv`, `user_health_data.csv`

### Step 2: Train NCF Model
```bash
python 2_train_ncf.py
```
**Outputs:** `best_ncf_model.pth`, `user_embeddings.npy`, `item_embeddings.npy`, `ncf_results.csv`

### Step 3: Evaluate NCF
```bash
python 3_evaluate_ncf.py
```
**Outputs:** Evaluation metrics and recommendation samples

### Step 4: Setup RL Environment
```bash
python 4_rl_environment.py
```
**Outputs:** RL-trained models in `rl_best_model/`

### Step 5: Compare Models
```bash
python 5_compare_models.py
```
**Outputs:** `comparison_results.csv`

### Step 6-8: Generate Paper Results
```bash
python 6_final_paper_sections.py
python 7_xai_paper_section.py
python 8_paper_checklist.py
```

## GPU Setup (Optional but Recommended)

### NVIDIA GPU with CUDA

1. Install CUDA Toolkit (matching PyTorch version)
2. Install cuDNN
3. PyTorch will automatically detect and use GPU

**Verify GPU availability:**
```python
import torch
print(torch.cuda.is_available())  # Should print True
print(torch.cuda.get_device_name(0))  # GPU name
```

### CPU-Only Setup

PyTorch will automatically fall back to CPU if GPU is not available. Training will be slower but still functional.

## Troubleshooting

### ImportError: No module named 'torch'
```bash
pip install torch torchvision torchaudio
```

### MemoryError during training
Reduce batch size or embedding dimension in the scripts:
```python
BATCH_SIZE = 64  # Reduce from 128
EMBEDDING_DIM = 32  # Reduce from 64
```

### File not found errors
Ensure all CSV files are in the correct location (project root directory)

### CUDA out of memory
```python
# Use CPU instead
device = torch.device('cpu')
```

## Project Structure Verification

After setup, verify your project has:
```
ncf22/
├── *.py              # 9 Python scripts
├── requirements.txt
├── README.md
├── .gitignore
├── .git/            # Git repository
└── (data files when datasets added)
```

## Next Steps

1. **Add your data**: Place CSV files in the project root
2. **Run preprocessing**: `python 1.py`
3. **Monitor training**: Check output logs
4. **Analyze results**: Review generated CSV files
5. **Iterate**: Modify hyperparameters and re-run as needed

## Tips for Success

- **Start small**: Test with a subset of data first
- **Monitor GPU**: Use `nvidia-smi` to watch GPU usage
- **Save checkpoints**: Model checkpoints are auto-saved during training
- **Use virtual env**: Prevents package conflicts with other projects
- **Version control**: Commit your changes regularly

## Environment Variables (Optional)

You can set environment variables to customize behavior:

```bash
# Use CPU only
export CUDA_VISIBLE_DEVICES=""

# Reduce memory usage
export OMP_NUM_THREADS=2
```

## Documentation References

- **README.md**: Project overview and usage
- **PROJECT_OVERVIEW.md**: Detailed project description
- **Code comments**: Inline documentation in *.py files
- **Paper sections**: Generated by scripts 6-8

## Getting Help

If you encounter issues:

1. Check the error message carefully
2. Review relevant code comments
3. Verify data file format
4. Try with smaller dataset
5. Check GPU availability (if using GPU)

## Environment Specifications

Tested on:
- Python 3.8, 3.9, 3.10, 3.11
- PyTorch 1.9+
- CUDA 11.0+ (optional)
- Windows, macOS, Linux

---

**Last Updated**: January 2026
